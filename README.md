# Bank_HTTP_With_MiddleWare
# –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π HTTP-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ Go

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π —è–¥—Ä–æ backend-—Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (–ø–ª–∞—Ç–µ–∂–∏ –∏ –ø–µ—Ä–µ–≤–æ–¥—ã –Ω–∞ —Å–±–µ—Ä–µ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Å—á—ë—Ç). –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–∫—É—Å ‚Äî –Ω–∞ **–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—â–∏–º –¥–∞–Ω–Ω—ã–º**, **–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤** –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ **–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ middleware**.

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –º–æ–µ–≥–æ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞—á–∏–Ω–∞—é—â–µ–≥–æ Go-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ–º—ã–µ –Ω–∞–≤—ã–∫–∏

*   **–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (Thread Safety)**: –î–ª—è –∑–∞—â–∏—Ç—ã –æ–±—â–∏—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –≥–æ–Ω–∫–∏ (data race) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è `sync.Mutex` (–¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π "–ø—Ä–æ–≤–µ—Ä–∏—Ç—å-—Å–ø–∏—Å–∞—Ç—å") –∏ `atomic.Int64` (–¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π).
*   **Chain of Responsibility Pattern**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ü–µ–ø–æ—á–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (middleware) –¥–ª—è —Å–∫–≤–æ–∑–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏.
*   **–ö–æ–Ω—Ç–µ–∫—Å—Ç (Context)**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `context.Context` –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (request ID) —á–µ—Ä–µ–∑ –≥—Ä–∞–Ω–∏—Ü—ã –º–µ–∂–¥—É middleware –∏ —Ö–µ–Ω–¥–ª–µ—Ä–∞–º–∏.
*   **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π**: –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ request ID, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –≤ production-—Å—Ä–µ–¥–µ.
*   **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫**: –í—Å–µ —ç—Ç–∞–ø—ã –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ (—á—Ç–µ–Ω–∏–µ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞, –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö) —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞—é—Ç—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫.

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
*   **–Ø–∑—ã–∫**: Go (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞: `net/http`, `sync`, `context` –∏ –¥—Ä.)
*   **–ö–æ–Ω—Ü–µ–ø—Ü–∏–∏**: HTTP-—Å–µ—Ä–≤–µ—Ä, Middleware, –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å, —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ main.go # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ /pay –∏ /save
‚îú‚îÄ‚îÄ middleware.go # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è middleware: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Request ID –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îî‚îÄ‚îÄ go.mod # –§–∞–π–ª –º–æ–¥—É–ª—è Go


## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞:**
    ```bash
    git clone https://github.com/Rkmfm2523/Bank_HTTP_With_MiddleWare.git
    cd Bank_HTTP_With_MiddleWare
    ```

2.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ HTTP-—Å–µ—Ä–≤–µ—Ä:**
    ```bash
    go run .
    ```
    –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É `:9097`.

## üì° API Endpoints

–°–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `POST` –∑–∞–ø—Ä–æ—Å—ã. –°—É–º–º–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —á–∏—Å–ª–æ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ (plain text).

### 1. –ü–ª–∞—Ç—ë–∂ (`POST /pay`)
–°–ø–∏—Å—ã–≤–∞–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—É—é —Å—É–º–º—É —Å –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ (`money`), –µ—Å–ª–∏ –Ω–∞ –Ω—ë–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤.
*   **–ó–∞–ø—Ä–æ—Å:** `POST /pay` —Å —Ç–µ–ª–æ–º `"150"`
*   **–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):** `"current balance: 850, current bank: 0"`
*   **–û—à–∏–±–∫–∞ (–Ω–µ—è–≤–Ω–æ 200, –Ω–æ —Å —Ç–µ–∫—Å—Ç–æ–º –æ—à–∏–±–∫–∏):** `"low balance"` (–µ—Å–ª–∏ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)

### 2. –ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Å—á—ë—Ç (`POST /save`)
–ü–µ—Ä–µ–≤–æ–¥–∏—Ç —É–∫–∞–∑–∞–Ω–Ω—É—é —Å—É–º–º—É —Å –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ (`money`) –Ω–∞ —Å–±–µ—Ä–µ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Å—á—ë—Ç (`bank`).
*   **–ó–∞–ø—Ä–æ—Å:** `POST /save` —Å —Ç–µ–ª–æ–º `"200"`
*   **–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):** `"current balance: 650, current bank: 200"`
*   **–û—à–∏–±–∫–∞ (–Ω–µ—è–≤–Ω–æ 200, –Ω–æ —Å —Ç–µ–∫—Å—Ç–æ–º –æ—à–∏–±–∫–∏):** `"low balance for bank transfer"`

## üîç –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

1.  **Middleware Chain**: –ö–∞–∂–¥—ã–π –≤—Ö–æ–¥—è—â–∏–π –∑–∞–ø—Ä–æ—Å —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ `RequestIDMiddleware`, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç/–∏–∑–≤–ª–µ–∫–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∏ –ø–æ–º–µ—â–∞–µ—Ç –µ–≥–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞. –ó–∞—Ç–µ–º `LoggingMiddleware` —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –Ω–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏, –ø–µ—Ä–µ–¥–∞—ë—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–ª—å—à–µ –∏ –ª–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
2.  **–û–±—Ä–∞–±–æ—Ç—á–∏–∫**: –ü–æ–ª—É—á–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –∏–∑–≤–ª–µ–∫–∞–µ—Ç `requestID` –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–∞—Ä—Å–∏—Ç —Å—É–º–º—É –∏–∑ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞.
3.  **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –ü–µ—Ä–µ–¥ –¥–æ—Å—Ç—É–ø–æ–º –∫ –≥–ª–æ–±–∞–ª—å–Ω—ã–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º `money` –∏ `bank` –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç—Å—è –º—å—é—Ç–µ–∫—Å (`mtx.Lock()`). –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –¥–≤–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å–∞ –∏ –µ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–∞–∫ –Ω–µ–¥–µ–ª–∏–º–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è.
4.  **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å —Å—Ä–µ–¥—Å—Ç–≤, –ø–æ—Å–ª–µ —á–µ–≥–æ –±–∞–ª–∞–Ω—Å—ã –∞—Ç–æ–º–∞—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `atomic.Int64.Add()`.

## üìä –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã (–ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞)
Server starting on port 9097...
[abc123def] Start POST /pay
[abc123def] Payment successful: 150, new balance: 850
[abc123def] End POST /pay - status: 200, duration: 1.2ms
[xyz789uvw] Start POST /save
[xyz789uvw] Transfer successful: 200, new balance: 650, bank: 200
[xyz789uvw] End POST /save - status: 200, duration: 0.8ms


## üß™ –í–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞

*   –î–æ–±–∞–≤–∏—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—É—é –±–∞–∑—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, PostgreSQL).
*   –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (JWT) –≤ –≤–∏–¥–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ middleware.
*   –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã).
*   –ù–∞–ø–∏—Å–∞—Ç—å unit- –∏ integration-—Ç–µ—Å—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `net/http/httptest`.
*   –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é Docker.
